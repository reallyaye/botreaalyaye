<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–§–∏—Ç–Ω–µ—Å-WebApp</title>
  <link rel="stylesheet" href="/static/styles.css">

  <script>
    (function() {
      // –ñ–¥—ë–º, –ø–æ–∫–∞ DOM –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è
      window.addEventListener('DOMContentLoaded', () => {
        // –ï—Å–ª–∏ –º—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Telegram WebApp
        const tg = window.Telegram?.WebApp;
        if (!tg) return;

        tg.ready();  // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
        // –ë–µ—Ä—ë–º –Ω–µ—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–º –µ—Å—Ç—å info –ø—Ä–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const uid = tg.initDataUnsafe?.user?.id;
        if (!uid) return;

        // –ï—Å–ª–∏ –≤ URL –µ—â—ë –Ω–µ—Ç user_id ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º
        const url = new URL(window.location.href);
        if (!url.searchParams.has('user_id')) {
          url.searchParams.set('user_id', uid);
          // –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ —Ç–æ—Ç –∂–µ –ø—É—Ç—å, –Ω–æ —Å ?user_id=...
          window.location.replace(url.toString());
        }
      });
    })();
  </script>
</head>
<body>
  <header>
    <h1>üèãÔ∏è –§–∏—Ç–Ω–µ—Å-WebApp</h1>
    {% set uid = request.query_params.get("user_id", "") %}
    <nav>
      <a href="/?user_id={{ uid }}">–ì–ª–∞–≤–Ω–∞—è</a> |
      <a href="/profile?user_id={{ uid }}">–ü—Ä–æ—Ñ–∏–ª—å</a> |
      <a href="/workouts?user_id={{ uid }}">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</a>
    </nav>
    <hr>
  </header>
  <main>
    {% block content %}{% endblock %}
  </main>
  <footer>
    <hr>
    <small>¬© 2025 –§–∏—Ç–Ω–µ—Å-WebApp</small>
  </footer>
</body>
</html>
